#+TITLE: Test Isometric Tiles
* test
#+BEGIN_SRC leisure :results dynamic
floop x = x + 1
floop 2
#+END_SRC
* Tiles
#+BEGIN_HTML :var map
<div class="map">
 {{#each map}}
   <div class="row {{#if_even @index}} even{{/if_even}}">
     {{#each this}}<div class="tile-sprite iso" data-letter="{{this}}" data-coords="{{@index}} {{@../index}}"></div>{{/each}}
   </div>
 {{/each}}
</div>
#+END_HTML

#+NAME: map
#+BEGIN_SRC yaml
- abcdefghijklmnop
- qrstuvwxyzABCDEF
- GHIJKLMNOP
#+END_SRC

#+NAME: tileTypeData
#+BEGIN_SRC yaml
floor:
  codes: abcdefghijk
  offsetX: 0
  offsetY: 0
  width: 64
  height: 32
walls:
  codes: lmnopq__rstuv
  offsetX: 0
  offsetY: 125
  width: 64
  height: 128
objects:
  codes: wx
  offsetX: 0
  offsetY: 640
  width: 64
  height: 64
rocks:
  codes: yzA
  offsetX: 0
  offsetY: 704
  width: 64
  height: 128
water:
  codes: BCDEFGH
  offsetX: 0
  offsetY: 832
  width: 64
  height: 64
#+END_SRC

#+BEGIN_SRC coffee :results def
Handlebars.registerHelper 'if_even', (conditional, options)->
  if (conditional % 2) == 0 then options.fn(this) else options.inverse(this)
#+END_SRC

#+BEGIN_SRC css
.map {
  margin-top: 3em;
  width: 1024px;
}
.row {
  height: 16px;
}
.even {
  padding-left: 32px;
}
.iso {
  display: inline-block;
  width: 64px;
  height: 32px;
}
#+END_SRC

Make sprites here. We can improve this later, putting all the sprites into on
image, etc.

#+BEGIN_SRC coffee :results def
Lounge.data.getFile "tiles/tileset_cave_1.png", (contents)->
  col = 0
  row = 0
  for v, k in "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOP"
    $(document.head).append """
      <style>
        .tile-sprite[data-letter="#{v}"] {
          background: url(data:image/png;base64,#{btoa contents}) no-repeat bottom;
          background-position: -#{col * 64}px -#{row * 32}px !important;
        }
      </style>
    """
    col += 1
    if col == 16
      col = 0
      row++
#+END_SRC
